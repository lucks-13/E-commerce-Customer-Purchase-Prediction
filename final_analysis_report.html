<!DOCTYPE html>
<html>
<head>
    <title>Final Analysis Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; background-color: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        h1 { color: #2c3e50; text-align: center; font-size: 2.5em; margin-bottom: 30px; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }
        .section { margin-bottom: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 10px; border-left: 5px solid #3498db; }
        .metric { background-color: white; padding: 15px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
        .metric-label { font-weight: bold; color: #2c3e50; }
        .metric-value { color: #27ae60; font-size: 1.2em; font-weight: bold; }
        .section h2 { color: #34495e; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        .highlight { background-color: #e8f6f3; border-left-color: #27ae60; }
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0; }
        .dashboard-card { background-color: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .dashboard-title { font-size: 0.9em; color: #7f8c8d; margin-bottom: 10px; }
        .dashboard-value { font-size: 2em; font-weight: bold; color: #2c3e50; }
        .recommendation { background-color: #d5f4e6; padding: 20px; border-radius: 10px; border: 2px solid #27ae60; margin: 20px 0; }
        .recommendation h3 { color: #27ae60; margin-top: 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>E-commerce Customer Purchase Prediction Report</h1>

        <div class="dashboard">
            <div class="dashboard-card">
                <div class="dashboard-title">Total Samples</div>
                <div class="dashboard-value">12,330</div>
            </div>
            <div class="dashboard-card">
                <div class="dashboard-title">Features Engineered</div>
                <div class="dashboard-value">48</div>
            </div>
            <div class="dashboard-card">
                <div class="dashboard-title">Models Tested</div>
                <div class="dashboard-value">8</div>
            </div>
            <div class="dashboard-card">
                <div class="dashboard-title">Best ROC-AUC</div>
                <div class="dashboard-value">0.931</div>
            </div>
        </div>

        <div class="section">
            <h2>1. Dataset Overview</h2>
            <div class="metric">
                <span class="metric-label">Dataset Shape</span>
                <span class="metric-value">(12330, 19)</span>
            </div>
            <div class="metric">
                <span class="metric-label">Missing Values</span>
                <span class="metric-value">0</span>
            </div>
            <div class="metric">
                <span class="metric-label">Target Distribution</span>
                <span class="metric-value">No Purchase: 10,422 | Purchase: 1,908</span>
            </div>
            <div class="metric">
                <span class="metric-label">Class Imbalance Ratio</span>
                <span class="metric-value">5.5:1</span>
            </div>
        </div>

        <div class="section">
            <h2>2. Feature Engineering</h2>
            <div class="metric">
                <span class="metric-label">Original Features</span>
                <span class="metric-value">19</span>
            </div>
            <div class="metric">
                <span class="metric-label">Engineered Features</span>
                <span class="metric-value">48</span>
            </div>
            <div class="metric">
                <span class="metric-label">New Features Created</span>
                <span class="metric-value">29</span>
            </div>
            <div class="metric">
                <span class="metric-label">Dimensionality Increase</span>
                <span class="metric-value">152.6%</span>
            </div>
        </div>

        <div class="section highlight">
            <h2>3. Model Performance Summary</h2>
            <div class="metric">
                <span class="metric-label">Best Performing Model</span>
                <span class="metric-value">GradientBoosting</span>
            </div>
            <div class="metric">
                <span class="metric-label">ROC-AUC Score</span>
                <span class="metric-value">0.9305</span>
            </div>
            <div class="metric">
                <span class="metric-label">Accuracy</span>
                <span class="metric-value">0.9015 (90.1%)</span>
            </div>
            <div class="metric">
                <span class="metric-label">F1-Score</span>
                <span class="metric-value">0.6453</span>
            </div>
            <div class="metric">
                <span class="metric-label">Precision</span>
                <span class="metric-value">0.7294</span>
            </div>
            <div class="metric">
                <span class="metric-label">Recall</span>
                <span class="metric-value">0.5785</span>
            </div>
        </div>

        <div class="section">
            <h2>4. Ensemble Methods</h2>
            <div class="metric">
                <span class="metric-label">Best Ensemble Method</span>
                <span class="metric-value">Soft_Voting</span>
            </div>
            <div class="metric">
                <span class="metric-label">Ensemble ROC-AUC</span>
                <span class="metric-value">0.9307</span>
            </div>
            <div class="metric">
                <span class="metric-label">Ensemble Accuracy</span>
                <span class="metric-value">0.9047</span>
            </div>
            <div class="metric">
                <span class="metric-label">Improvement over Single Model</span>
                <span class="metric-value">0.02% ROC-AUC</span>
            </div>
        </div>

        <div class="section">
            <h2>5. Cross-Validation Stability</h2>
            <div class="metric">
                <span class="metric-label">10-Fold CV Score</span>
                <span class="metric-value">0.9329 ± 0.0070</span>
            </div>
            <div class="metric">
                <span class="metric-label">Bootstrap Validation</span>
                <span class="metric-value">0.9311 ± 0.0041</span>
            </div>
            <div class="metric">
                <span class="metric-label">Model Stability</span>
                <span class="metric-value">High</span>
            </div>
        </div>

        <div class="recommendation">
            <h3>Production Deployment Recommendation</h3>
            <div class="metric">
                <span class="metric-label">Recommended Model</span>
                <span class="metric-value">RandomForest</span>
            </div>
            <div class="metric">
                <span class="metric-label">Expected Performance</span>
                <span class="metric-value">93.1% ROC-AUC</span>
            </div>
            <div class="metric">
                <span class="metric-label">Business Impact</span>
                <span class="metric-value">High</span>
            </div>
            <div class="metric">
                <span class="metric-label">Production Readiness</span>
                <span class="metric-value">Ready</span>
            </div>
        </div>

        <div class="section">
            <h2>6. Key Insights & Next Steps</h2>
            <ul style="font-size: 1.1em; line-height: 1.6;">
                <li><strong>Feature Engineering Impact:</strong> Created 29 additional features improving model performance</li>
                <li><strong>Model Selection:</strong> GradientBoosting outperformed 7 other algorithms</li>
                <li><strong>Class Imbalance:</strong> Successfully handled 5.5:1 imbalanced dataset</li>
                <li><strong>Ensemble Benefits:</strong> Ensemble methods provided 0.02% improvement</li>
                <li><strong>Validation Confidence:</strong> Cross-validation confirms model generalization capability</li>
            </ul>
        </div>

        <div style="text-align: center; margin-top: 40px; padding: 20px; background-color: #ecf0f1; border-radius: 10px;">
            <h3 style="color: #2c3e50; margin: 0;">Analysis Complete</h3>
            <p style="color: #7f8c8d; margin: 10px 0 0 0;">All results exported successfully | Model ready for production deployment</p>
        </div>
    </div>
</body>
</html>